#!/bin/bash
while true;
do
	{ export TMPDIR="/home/hamker/site/z/";echo "Service Statistics"; echo "-------------------"; echo;echo; echo "Network";echo "----------";echo 'Domain: hamker.me'; echo 'IP: ' $(curl ifconfig.me); echo 'Logged IP: ' $(sudo awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -nr | wc -l); echo; echo; echo "Webdav";echo "-------"; echo 'Size: ' $(du -hs /home/hamker/site/z/ | awk '{print $1}'); echo "Total: "$(ls $TMPDIR/ | wc -l);echo "Text: "$(ls $TMPDIR/*.txt $TMPDIR/*.conf 2>/dev/null | wc -l);echo "Images: "$(ls $TMPDIR/*.jpg $TMPDIR/*.jpeg $TMPDIR/*.png 2>/dev/null | wc -l);echo "Audio: "$(ls $TMPDIR/*.opus $TMPDIR/*.mp3 $TMPDIR/*.aac $TMPDIR/*.ogg 2>/dev/null | wc -l);echo "Video: "$(ls $TMPDIR/*.mp4 $TMPDIR/*.mkv $TMPDIR/*.webm 2>/dev/null | wc -l);echo "Compressed: "$(ls $TMPDIR/*.zip $TMPDIR/*.rar $TMPDIR/*.tar.xz $TMPDIR/*.tar.gz $TMPDIR/*.tar.bz2 2>/dev/null | wc -l);echo;echo "Resource Usage";echo "---------------"; echo 'Memory:' $(free -h | grep '^Mem:' | awk '{print $3"B/"$2"B"}'); echo 'Swap: ' $(free -h | grep '^Swap:' | awk '{print $3"B/"$2"B"}');echo 'CPU: Intel Xeon (2) @ 2.200GHz ' $(mpstat | awk '$12 ~ /[0-9.]+/ { print (100 - $12)"%"}'); echo "Disk: " $(df -h / | tail -n+2 | awk '{print $3"/"$2,"("$5")"}');echo "Uptime: " $(uptime -p);  echo;echo;echo;echo;echo;echo;echo;echo;echo "Weather: "$(curl -s wttr.in/Delhi?format=%t); echo; echo "Last Updated: " $(date);echo; echo "Next Update: " $(date --date='10 minutes');  } | ansifilter > /home/hamker/site/index.txt && cat /home/hamker/site/index.txt | /var/tmp/ansi2html.sh --bg=dark --palette=tango > /home/hamker/site/index.html ; ansilove -q -f terminus -c 110 -o /home/hamker/site/preview.png /home/hamker/site/index.txt ;
	sleep 600;
done
